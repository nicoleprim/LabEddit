{"ast":null,"code":"import _slicedToArray from\"/home/nicole/alves-Nicole-Prim/modulo3/projeto-labeddit/projeto-labbedit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{BASE_URL}from'../../Constants/urls';import{useProtectedPage}from'../../Hooks/useProtectedPage';import{useRequestData}from'../../Hooks/useRequestData';import CardComments from'../../Components/CardComments/CardComments';import{useForm}from'../../Hooks/useForm';import{createComment}from'../../Services/Posts';import LoadingLogin from'../../Assets/loadinglogin.gif';import Loading from'../../Components/Loading/Loading';import{Container,Post,User,Text,Icones,Dados}from'../../Components/CardPost/Styled';import Comentario from'../../Assets/comentarios.svg';import FlechaUm from'../../Assets/cima.svg';import FlechaDois from'../../Assets/baixo.svg';import{ContainerPost}from'./Styled';import Line from'../../Assets/Line.svg';import{ContainerForm,Inputs,InputDois,ButtonForm,DivLine}from'./Styled';import axios from'axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PostDetailPage=function PostDetailPage(){useProtectedPage();var params=useParams();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),refresh=_useState2[0],setRefresh=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),like=_useState4[0],setLike=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),dislike=_useState6[0],setDislike=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var comments=useRequestData([],\"\".concat(BASE_URL,\"/posts/\").concat(params.id,\"/comments\"),refresh);var _useForm=useForm({body:\"\"}),form=_useForm.form,onChange=_useForm.onChange,cleanFields=_useForm.cleanFields;var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),post=_useState10[0],setPost=_useState10[1];useEffect(function(){var postLocal=JSON.parse(localStorage.getItem(\"post\"));postLocal&&setPost(postLocal);},[]);var onSubmitForm=function onSubmitForm(event){event.preventDefault();createComment(form,params.id,cleanFields,setRefresh,refresh,setIsLoading);};var voteLike=function voteLike(id){if(like===true){voteRemove(setLike,like,id);setLike(!like);}else{var body={direction:1};axios.post(\"\".concat(BASE_URL,\"/comments/\").concat(id,\"/votes\"),body,{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(res){console.log(res);setLike(!like);setRefresh(!refresh);}).catch(function(err){console.log(err.response);});}};var voteDislike=function voteDislike(id){if(dislike===true){voteRemove(setDislike,dislike,id);setDislike(!dislike);}else{var body={direction:-1};axios.put(\"\".concat(BASE_URL,\"/comments/\").concat(id,\"/votes\"),body,{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(res){setDislike(!dislike);setRefresh(!refresh);}).catch(function(err){alert(err.response);});}};var voteRemove=function voteRemove(setVote,voteName,id){axios.delete(\"\".concat(BASE_URL,\"/comments/\").concat(id,\"/votes\"),{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(res){setVote(!voteName);setRefresh(!refresh);}).catch(function(err){alert(err.response.data);});};return/*#__PURE__*/_jsx(_Fragment,{children:comments?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ContainerPost,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(Post,{children:[/*#__PURE__*/_jsxs(User,{children:[\"Enviado por: \",post.username,\" \"]}),/*#__PURE__*/_jsxs(Text,{children:[\" \",post.body,\" \"]})]}),/*#__PURE__*/_jsxs(Icones,{children:[/*#__PURE__*/_jsxs(Dados,{children:[/*#__PURE__*/_jsx(\"img\",{src:FlechaUm,alt:\"\\xEDcone flecha\"}),post.voteSum,/*#__PURE__*/_jsx(\"img\",{src:FlechaDois,alt:\"\\xEDcone flecha\"})]}),/*#__PURE__*/_jsxs(Dados,{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:Comentario,alt:\"\\xEDcone comentarios\"}),\" \",post.commentCount,\" \"]})]})]})}),/*#__PURE__*/_jsxs(ContainerForm,{onSubmit:onSubmitForm,children:[/*#__PURE__*/_jsx(Inputs,{children:/*#__PURE__*/_jsx(InputDois,{name:\"body\",type:\"text\",onChange:onChange,value:form.body,placeholder:\"Adicionar coment\\xE1rio\",required:true})}),/*#__PURE__*/_jsx(ButtonForm,{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:isLoading?/*#__PURE__*/_jsx(\"img\",{width:'30px',src:LoadingLogin,alt:\"gif carregando\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"Responder\"})})})]}),/*#__PURE__*/_jsx(DivLine,{children:/*#__PURE__*/_jsx(\"img\",{src:Line,alt:\"linha\"})}),/*#__PURE__*/_jsx(CardComments,{comments:comments,voteLike:voteLike,voteDislike:voteDislike})]}):/*#__PURE__*/_jsx(Loading,{})});};export default PostDetailPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","BASE_URL","useProtectedPage","useRequestData","CardComments","useForm","createComment","LoadingLogin","Loading","Container","Post","User","Text","Icones","Dados","Comentario","FlechaUm","FlechaDois","ContainerPost","Line","ContainerForm","Inputs","InputDois","ButtonForm","DivLine","axios","PostDetailPage","params","refresh","setRefresh","like","setLike","dislike","setDislike","isLoading","setIsLoading","comments","id","body","form","onChange","cleanFields","post","setPost","postLocal","JSON","parse","localStorage","getItem","onSubmitForm","event","preventDefault","voteLike","voteRemove","direction","headers","Authorization","then","res","console","log","catch","err","response","voteDislike","put","alert","setVote","voteName","delete","data","username","voteSum","commentCount"],"sources":["/home/nicole/alves-Nicole-Prim/modulo3/projeto-labeddit/projeto-labbedit/src/Pages/PostDetailPage/PostDetailPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { BASE_URL } from '../../Constants/urls'\nimport { useProtectedPage } from '../../Hooks/useProtectedPage'\nimport { useRequestData } from '../../Hooks/useRequestData'\nimport CardComments from '../../Components/CardComments/CardComments'\nimport { useForm } from '../../Hooks/useForm'\nimport { createComment } from '../../Services/Posts'\nimport LoadingLogin from '../../Assets/loadinglogin.gif'\nimport Loading from '../../Components/Loading/Loading'\nimport { Container, Post, User, Text, Icones, Dados } from '../../Components/CardPost/Styled'\nimport Comentario from '../../Assets/comentarios.svg'\nimport FlechaUm from '../../Assets/cima.svg'\nimport FlechaDois from '../../Assets/baixo.svg'\nimport { ContainerPost } from './Styled'\nimport Line from '../../Assets/Line.svg'\nimport { ContainerForm, Inputs, InputDois, ButtonForm, DivLine } from './Styled'\nimport axios from 'axios'\n\nconst PostDetailPage = () => {\n    useProtectedPage()\n    const params = useParams()\n    const [refresh, setRefresh] = useState(false)\n    const [like, setLike] = useState(false)\n    const [dislike, setDislike] = useState(false)\n    const [isLoading, setIsLoading] = useState(false)\n    const comments = useRequestData([], `${BASE_URL}/posts/${params.id}/comments`, refresh)\n    const { form, onChange, cleanFields } = useForm({ body: \"\" })\n    const [post, setPost] = useState({})\n\n    useEffect(() => {\n        const postLocal = JSON.parse(localStorage.getItem(\"post\"))\n        postLocal && setPost(postLocal)\n    }, [])\n\n    const onSubmitForm = (event) => {\n        event.preventDefault()\n        createComment(form, params.id, cleanFields, setRefresh, refresh, setIsLoading)\n    }\n\n    const voteLike = (id) => {\n        if (like === true) {\n          voteRemove(setLike, like, id)\n          setLike(!like)\n        } else {\n          const body = { direction: 1 }\n          axios.post(`${BASE_URL}/comments/${id}/votes`, body, {\n            headers: {\n              Authorization: localStorage.getItem(\"token\")\n            }\n          }).then((res) => {\n            console.log(res)\n            setLike(!like)\n            setRefresh(!refresh)\n          }).catch((err) => {\n            console.log(err.response)\n          })\n        }\n      }\n    \n      const voteDislike = (id) => {\n        if (dislike === true) {\n          voteRemove(setDislike, dislike, id)\n          setDislike(!dislike)\n        } else {\n          const body = { direction: -1 }\n          axios.put(`${BASE_URL}/comments/${id}/votes`, body, {\n            headers: {\n              Authorization: localStorage.getItem(\"token\")\n            }\n          })\n            .then((res) => {\n              setDislike(!dislike)\n              setRefresh(!refresh)\n            })\n            .catch((err) => {\n              alert(err.response)\n            })\n        }\n      }\n    \n      const voteRemove = (setVote, voteName, id) => {\n        axios.delete(`${BASE_URL}/comments/${id}/votes`, {\n          headers: {\n            Authorization: localStorage.getItem(\"token\")\n          }\n        })\n          .then((res) => {\n            setVote(!voteName)\n            setRefresh(!refresh)\n          })\n          .catch((err) => {\n            alert(err.response.data)\n          })\n      }\n\n    return (\n        <>\n            {comments ?\n                <>\n                    <ContainerPost>\n                        <Container>\n                            <Post>\n                                <User>Enviado por: {post.username} </User>\n                                <Text> {post.body} </Text>\n                            </Post>\n                            <Icones>\n                                <Dados>\n                                    <img src={FlechaUm} alt=\"ícone flecha\" />\n                                    {post.voteSum}\n                                    <img src={FlechaDois} alt=\"ícone flecha\" />\n                                </Dados>\n                                <Dados> <img src={Comentario} alt=\"ícone comentarios\" /> {post.commentCount} </Dados>\n                            </Icones>\n                        </Container>\n                    </ContainerPost>\n                    <ContainerForm onSubmit={onSubmitForm}>\n                        <Inputs>\n                            <InputDois\n                                name=\"body\"\n                                type=\"text\"\n                                onChange={onChange}\n                                value={form.body}\n                                placeholder=\"Adicionar comentário\"\n                                required\n                            />\n                        </Inputs>\n                        <ButtonForm>\n                            <button type=\"submit\">\n                                {isLoading ? <img width={'30px'} src={LoadingLogin} alt=\"gif carregando\" /> : <>Responder</>}\n                            </button>\n                        </ButtonForm>\n                    </ContainerForm>\n                    <DivLine>\n                        <img src={Line} alt=\"linha\" />\n                    </DivLine>\n                    <CardComments comments={comments} voteLike={voteLike} voteDislike={voteDislike} />\n                </>\n\n                : <Loading />\n            }\n        </>\n    )\n}\n\nexport default PostDetailPage"],"mappings":"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"},"metadata":{},"sourceType":"module"}