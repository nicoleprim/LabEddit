{"ast":null,"code":"import _slicedToArray from\"/home/nicole/alves-Nicole-Prim/modulo3/projeto-labeddit/projeto-labbedit/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{BASE_URL}from'../../Constants/urls';import{useProtectedPage}from'../../Hooks/useProtectedPage';import{useRequestData}from'../../Hooks/useRequestData';import CardComments from'../../Components/CardComments/CardComments';import{useForm}from'../../Hooks/useForm';import{createComment}from'../../Services/Posts';import LoadingLogin from'../../Assets/loadinglogin.gif';import Loading from'../../Components/Loading/Loading';import{Post,User,Text,Icones,IconesUm,Comentarios,Dados}from'../../Components/CardPost/Styled';import Comentario from'../../Assets/comentarios.svg';import FlechaUm from'../../Assets/cima.svg';import FlechaDois from'../../Assets/baixo.svg';import{Container}from'./Styled';import Line from'../../Assets/Line.svg';import{ContainerForm,ContainerPost,Inputs,InputDois,ButtonForm,DivLine}from'./Styled';import axios from'axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PostDetailPage=function PostDetailPage(){useProtectedPage();var params=useParams();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),refresh=_useState2[0],setRefresh=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),like=_useState4[0],setLike=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),dislike=_useState6[0],setDislike=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var comments=useRequestData([],\"\".concat(BASE_URL,\"/posts/\").concat(params.id,\"/comments\"),refresh);var _useForm=useForm({body:\"\"}),form=_useForm.form,onChange=_useForm.onChange,cleanFields=_useForm.cleanFields;var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),post=_useState10[0],setPost=_useState10[1];var posts=useRequestData([],\"\".concat(BASE_URL,\"/posts\"),refresh);var onSubmitForm=function onSubmitForm(event){event.preventDefault();createComment(form,params.id,cleanFields,setRefresh,refresh,setIsLoading);};var voteLike=function voteLike(id){if(like===true){voteRemove(setLike,like,id);setLike(!like);}else{var body={direction:1};axios.post(\"\".concat(BASE_URL,\"/comments/\").concat(id,\"/votes\"),body,{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(res){setLike(!like);setRefresh(!refresh);}).catch(function(err){console.log(err.response);});}};var voteDislike=function voteDislike(id){if(dislike===true){voteRemove(setDislike,dislike,id);setDislike(!dislike);}else{var body={direction:-1};axios.put(\"\".concat(BASE_URL,\"/comments/\").concat(id,\"/votes\"),body,{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(res){setDislike(!dislike);setRefresh(!refresh);}).catch(function(err){alert(err.response);});}};var voteRemove=function voteRemove(setVote,voteName,id){axios.delete(\"\".concat(BASE_URL,\"/comments/\").concat(id,\"/votes\"),{headers:{Authorization:localStorage.getItem(\"token\")}}).then(function(res){setVote(!voteName);setRefresh(!refresh);}).catch(function(err){alert(err.response.data);});};var getPost=posts.map(function(post){if(post.id===params.id){return/*#__PURE__*/_jsx(ContainerPost,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(User,{children:[\"Enviado por: \",post.username,\" \"]}),/*#__PURE__*/_jsxs(Text,{children:[\" \",post.body,\" \"]}),/*#__PURE__*/_jsxs(Icones,{children:[/*#__PURE__*/_jsxs(IconesUm,{children:[/*#__PURE__*/_jsx(\"img\",{src:FlechaUm,alt:\"\\xEDcone flecha\"}),/*#__PURE__*/_jsxs(\"p\",{children:[post.voteSum,\" \"]}),/*#__PURE__*/_jsx(\"img\",{src:FlechaDois,alt:\"\\xEDcone flecha\"})]}),/*#__PURE__*/_jsxs(Comentarios,{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:Comentario,alt:\"\\xEDcone comentarios\"}),\"  \",/*#__PURE__*/_jsx(\"p\",{children:post.commentCount}),\" \"]})]})]})});}else{return/*#__PURE__*/_jsx(\"div\",{},post.id);}});return/*#__PURE__*/_jsx(_Fragment,{children:comments?/*#__PURE__*/_jsxs(_Fragment,{children:[getPost,/*#__PURE__*/_jsxs(ContainerForm,{onSubmit:onSubmitForm,children:[/*#__PURE__*/_jsx(Inputs,{children:/*#__PURE__*/_jsx(InputDois,{name:\"body\",type:\"text\",onChange:onChange,value:form.body,placeholder:\"Adicionar coment\\xE1rio\",required:true})}),/*#__PURE__*/_jsx(ButtonForm,{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:isLoading?/*#__PURE__*/_jsx(\"img\",{width:'30px',src:LoadingLogin,alt:\"gif carregando\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"Responder\"})})})]}),/*#__PURE__*/_jsx(DivLine,{children:/*#__PURE__*/_jsx(\"img\",{src:Line,alt:\"linha\"})}),/*#__PURE__*/_jsx(CardComments,{comments:comments,voteLike:voteLike,voteDislike:voteDislike})]}):/*#__PURE__*/_jsx(Loading,{})});};export default PostDetailPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","BASE_URL","useProtectedPage","useRequestData","CardComments","useForm","createComment","LoadingLogin","Loading","Post","User","Text","Icones","IconesUm","Comentarios","Dados","Comentario","FlechaUm","FlechaDois","Container","Line","ContainerForm","ContainerPost","Inputs","InputDois","ButtonForm","DivLine","axios","PostDetailPage","params","refresh","setRefresh","like","setLike","dislike","setDislike","isLoading","setIsLoading","comments","id","body","form","onChange","cleanFields","post","setPost","posts","onSubmitForm","event","preventDefault","voteLike","voteRemove","direction","headers","Authorization","localStorage","getItem","then","res","catch","err","console","log","response","voteDislike","put","alert","setVote","voteName","delete","data","getPost","map","username","voteSum","commentCount"],"sources":["/home/nicole/alves-Nicole-Prim/modulo3/projeto-labeddit/projeto-labbedit/src/Pages/PostDetailPage/PostDetailPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { BASE_URL } from '../../Constants/urls'\nimport { useProtectedPage } from '../../Hooks/useProtectedPage'\nimport { useRequestData } from '../../Hooks/useRequestData'\nimport CardComments from '../../Components/CardComments/CardComments'\nimport { useForm } from '../../Hooks/useForm'\nimport { createComment } from '../../Services/Posts'\nimport LoadingLogin from '../../Assets/loadinglogin.gif'\nimport Loading from '../../Components/Loading/Loading'\nimport { Post, User, Text, Icones, IconesUm, Comentarios, Dados } from '../../Components/CardPost/Styled'\nimport Comentario from '../../Assets/comentarios.svg'\nimport FlechaUm from '../../Assets/cima.svg'\nimport FlechaDois from '../../Assets/baixo.svg'\nimport { Container } from './Styled'\nimport Line from '../../Assets/Line.svg'\nimport { ContainerForm, ContainerPost, Inputs, InputDois, ButtonForm, DivLine } from './Styled'\nimport axios from 'axios'\n\nconst PostDetailPage = () => {\n  useProtectedPage()\n  const params = useParams()\n  const [refresh, setRefresh] = useState(false)\n  const [like, setLike] = useState(false)\n  const [dislike, setDislike] = useState(false)\n  const [isLoading, setIsLoading] = useState(false)\n  const comments = useRequestData([], `${BASE_URL}/posts/${params.id}/comments`, refresh)\n  const { form, onChange, cleanFields } = useForm({ body: \"\" })\n  const [post, setPost] = useState({})\n  const posts = useRequestData([], `${BASE_URL}/posts`, refresh)\n\n  const onSubmitForm = (event) => {\n    event.preventDefault()\n    createComment(form, params.id, cleanFields, setRefresh, refresh, setIsLoading)\n  }\n\n  const voteLike = (id) => {\n    if (like === true) {\n      voteRemove(setLike, like, id)\n      setLike(!like)\n    } else {\n      const body = { direction: 1 }\n      axios.post(`${BASE_URL}/comments/${id}/votes`, body, {\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        }\n      }).then((res) => {\n        setLike(!like)\n        setRefresh(!refresh)\n      }).catch((err) => {\n        console.log(err.response)\n      })\n    }\n  }\n\n  const voteDislike = (id) => {\n    if (dislike === true) {\n      voteRemove(setDislike, dislike, id)\n      setDislike(!dislike)\n    } else {\n      const body = { direction: -1 }\n      axios.put(`${BASE_URL}/comments/${id}/votes`, body, {\n        headers: {\n          Authorization: localStorage.getItem(\"token\")\n        }\n      })\n        .then((res) => {\n          setDislike(!dislike)\n          setRefresh(!refresh)\n        })\n        .catch((err) => {\n          alert(err.response)\n        })\n    }\n  }\n\n  const voteRemove = (setVote, voteName, id) => {\n    axios.delete(`${BASE_URL}/comments/${id}/votes`, {\n      headers: {\n        Authorization: localStorage.getItem(\"token\")\n      }\n    })\n      .then((res) => {\n        setVote(!voteName)\n        setRefresh(!refresh)\n      })\n      .catch((err) => {\n        alert(err.response.data)\n      })\n  }\n\n  const getPost = posts.map((post) => {\n    if (post.id === params.id) {\n      return (\n        <ContainerPost>\n        <Container>\n          <User>Enviado por: {post.username} </User>\n          <Text> {post.body} </Text>\n          <Icones>\n            <IconesUm>\n              <img src={FlechaUm} alt=\"ícone flecha\" />\n              <p>{post.voteSum} </p>\n              <img src={FlechaDois} alt=\"ícone flecha\" />\n            </IconesUm>\n            <Comentarios> <img src={Comentario} alt=\"ícone comentarios\" />  <p>{post.commentCount}</p> </Comentarios>\n          </Icones>\n        </Container>\n      </ContainerPost>\n      )\n    }else {\n      return (<div key={post.id}></div>)\n    }\n  })\n\n  return (\n    <>\n      {comments ?\n        <>\n        {getPost}\n          <ContainerForm onSubmit={onSubmitForm}>\n            <Inputs>\n              <InputDois\n                name=\"body\"\n                type=\"text\"\n                onChange={onChange}\n                value={form.body}\n                placeholder=\"Adicionar comentário\"\n                required\n              />\n            </Inputs>\n            <ButtonForm>\n              <button type=\"submit\">\n                {isLoading ? <img width={'30px'} src={LoadingLogin} alt=\"gif carregando\" /> : <>Responder</>}\n              </button>\n            </ButtonForm>\n          </ContainerForm>\n          <DivLine>\n            <img src={Line} alt=\"linha\" />\n          </DivLine>\n          <CardComments comments={comments} voteLike={voteLike} voteDislike={voteDislike} />\n        </>\n        : <Loading />\n      }\n    </>\n  )\n}\n\nexport default PostDetailPage"],"mappings":"8JAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,SAAT,KAA0B,kBAA1B,CACA,OAASC,QAAT,KAAyB,sBAAzB,CACA,OAASC,gBAAT,KAAiC,8BAAjC,CACA,OAASC,cAAT,KAA+B,4BAA/B,CACA,MAAOC,aAAP,KAAyB,4CAAzB,CACA,OAASC,OAAT,KAAwB,qBAAxB,CACA,OAASC,aAAT,KAA8B,sBAA9B,CACA,MAAOC,aAAP,KAAyB,+BAAzB,CACA,MAAOC,QAAP,KAAoB,kCAApB,CACA,OAASC,IAAT,CAAeC,IAAf,CAAqBC,IAArB,CAA2BC,MAA3B,CAAmCC,QAAnC,CAA6CC,WAA7C,CAA0DC,KAA1D,KAAuE,kCAAvE,CACA,MAAOC,WAAP,KAAuB,8BAAvB,CACA,MAAOC,SAAP,KAAqB,uBAArB,CACA,MAAOC,WAAP,KAAuB,wBAAvB,CACA,OAASC,SAAT,KAA0B,UAA1B,CACA,MAAOC,KAAP,KAAiB,uBAAjB,CACA,OAASC,aAAT,CAAwBC,aAAxB,CAAuCC,MAAvC,CAA+CC,SAA/C,CAA0DC,UAA1D,CAAsEC,OAAtE,KAAqF,UAArF,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,6IAEA,GAAMC,eAAc,CAAG,QAAjBA,eAAiB,EAAM,CAC3B1B,gBAAgB,GAChB,GAAM2B,OAAM,CAAG7B,SAAS,EAAxB,CACA,cAA8BD,QAAQ,CAAC,KAAD,CAAtC,wCAAO+B,OAAP,eAAgBC,UAAhB,eACA,eAAwBhC,QAAQ,CAAC,KAAD,CAAhC,yCAAOiC,IAAP,eAAaC,OAAb,eACA,eAA8BlC,QAAQ,CAAC,KAAD,CAAtC,yCAAOmC,OAAP,eAAgBC,UAAhB,eACA,eAAkCpC,QAAQ,CAAC,KAAD,CAA1C,yCAAOqC,SAAP,eAAkBC,YAAlB,eACA,GAAMC,SAAQ,CAAGnC,cAAc,CAAC,EAAD,WAAQF,QAAR,mBAA0B4B,MAAM,CAACU,EAAjC,cAAgDT,OAAhD,CAA/B,CACA,aAAwCzB,OAAO,CAAC,CAAEmC,IAAI,CAAE,EAAR,CAAD,CAA/C,CAAQC,IAAR,UAAQA,IAAR,CAAcC,QAAd,UAAcA,QAAd,CAAwBC,WAAxB,UAAwBA,WAAxB,CACA,eAAwB5C,QAAQ,CAAC,EAAD,CAAhC,0CAAO6C,IAAP,gBAAaC,OAAb,gBACA,GAAMC,MAAK,CAAG3C,cAAc,CAAC,EAAD,WAAQF,QAAR,WAA0B6B,OAA1B,CAA5B,CAEA,GAAMiB,aAAY,CAAG,QAAfA,aAAe,CAACC,KAAD,CAAW,CAC9BA,KAAK,CAACC,cAAN,GACA3C,aAAa,CAACmC,IAAD,CAAOZ,MAAM,CAACU,EAAd,CAAkBI,WAAlB,CAA+BZ,UAA/B,CAA2CD,OAA3C,CAAoDO,YAApD,CAAb,CACD,CAHD,CAKA,GAAMa,SAAQ,CAAG,QAAXA,SAAW,CAACX,EAAD,CAAQ,CACvB,GAAIP,IAAI,GAAK,IAAb,CAAmB,CACjBmB,UAAU,CAAClB,OAAD,CAAUD,IAAV,CAAgBO,EAAhB,CAAV,CACAN,OAAO,CAAC,CAACD,IAAF,CAAP,CACD,CAHD,IAGO,CACL,GAAMQ,KAAI,CAAG,CAAEY,SAAS,CAAE,CAAb,CAAb,CACAzB,KAAK,CAACiB,IAAN,WAAc3C,QAAd,sBAAmCsC,EAAnC,WAA+CC,IAA/C,CAAqD,CACnDa,OAAO,CAAE,CACPC,aAAa,CAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,CADR,CAD0C,CAArD,EAIGC,IAJH,CAIQ,SAACC,GAAD,CAAS,CACfzB,OAAO,CAAC,CAACD,IAAF,CAAP,CACAD,UAAU,CAAC,CAACD,OAAF,CAAV,CACD,CAPD,EAOG6B,KAPH,CAOS,SAACC,GAAD,CAAS,CAChBC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,QAAhB,EACD,CATD,EAUD,CACF,CAjBD,CAmBA,GAAMC,YAAW,CAAG,QAAdA,YAAc,CAACzB,EAAD,CAAQ,CAC1B,GAAIL,OAAO,GAAK,IAAhB,CAAsB,CACpBiB,UAAU,CAAChB,UAAD,CAAaD,OAAb,CAAsBK,EAAtB,CAAV,CACAJ,UAAU,CAAC,CAACD,OAAF,CAAV,CACD,CAHD,IAGO,CACL,GAAMM,KAAI,CAAG,CAAEY,SAAS,CAAE,CAAC,CAAd,CAAb,CACAzB,KAAK,CAACsC,GAAN,WAAahE,QAAb,sBAAkCsC,EAAlC,WAA8CC,IAA9C,CAAoD,CAClDa,OAAO,CAAE,CACPC,aAAa,CAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,CADR,CADyC,CAApD,EAKGC,IALH,CAKQ,SAACC,GAAD,CAAS,CACbvB,UAAU,CAAC,CAACD,OAAF,CAAV,CACAH,UAAU,CAAC,CAACD,OAAF,CAAV,CACD,CARH,EASG6B,KATH,CASS,SAACC,GAAD,CAAS,CACdM,KAAK,CAACN,GAAG,CAACG,QAAL,CAAL,CACD,CAXH,EAYD,CACF,CAnBD,CAqBA,GAAMZ,WAAU,CAAG,QAAbA,WAAa,CAACgB,OAAD,CAAUC,QAAV,CAAoB7B,EAApB,CAA2B,CAC5CZ,KAAK,CAAC0C,MAAN,WAAgBpE,QAAhB,sBAAqCsC,EAArC,WAAiD,CAC/Cc,OAAO,CAAE,CACPC,aAAa,CAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,CADR,CADsC,CAAjD,EAKGC,IALH,CAKQ,SAACC,GAAD,CAAS,CACbS,OAAO,CAAC,CAACC,QAAF,CAAP,CACArC,UAAU,CAAC,CAACD,OAAF,CAAV,CACD,CARH,EASG6B,KATH,CASS,SAACC,GAAD,CAAS,CACdM,KAAK,CAACN,GAAG,CAACG,QAAJ,CAAaO,IAAd,CAAL,CACD,CAXH,EAYD,CAbD,CAeA,GAAMC,QAAO,CAAGzB,KAAK,CAAC0B,GAAN,CAAU,SAAC5B,IAAD,CAAU,CAClC,GAAIA,IAAI,CAACL,EAAL,GAAYV,MAAM,CAACU,EAAvB,CAA2B,CACzB,mBACE,KAAC,aAAD,wBACA,MAAC,SAAD,yBACE,MAAC,IAAD,4BAAoBK,IAAI,CAAC6B,QAAzB,OADF,cAEE,MAAC,IAAD,gBAAQ7B,IAAI,CAACJ,IAAb,OAFF,cAGE,MAAC,MAAD,yBACE,MAAC,QAAD,yBACE,YAAK,GAAG,CAAEvB,QAAV,CAAoB,GAAG,CAAC,iBAAxB,EADF,cAEE,qBAAI2B,IAAI,CAAC8B,OAAT,OAFF,cAGE,YAAK,GAAG,CAAExD,UAAV,CAAsB,GAAG,CAAC,iBAA1B,EAHF,GADF,cAME,MAAC,WAAD,6BAAc,YAAK,GAAG,CAAEF,UAAV,CAAsB,GAAG,CAAC,sBAA1B,EAAd,mBAAgE,mBAAI4B,IAAI,CAAC+B,YAAT,EAAhE,OANF,GAHF,GADA,EADF,CAgBD,CAjBD,IAiBM,CACJ,mBAAQ,cAAU/B,IAAI,CAACL,EAAf,CAAR,CACD,CACF,CArBe,CAAhB,CAuBA,mBACE,yBACGD,QAAQ,cACP,2BACCiC,OADD,cAEE,MAAC,aAAD,EAAe,QAAQ,CAAExB,YAAzB,wBACE,KAAC,MAAD,wBACE,KAAC,SAAD,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,MAFP,CAGE,QAAQ,CAAEL,QAHZ,CAIE,KAAK,CAAED,IAAI,CAACD,IAJd,CAKE,WAAW,CAAC,yBALd,CAME,QAAQ,KANV,EADF,EADF,cAWE,KAAC,UAAD,wBACE,eAAQ,IAAI,CAAC,QAAb,UACGJ,SAAS,cAAG,YAAK,KAAK,CAAE,MAAZ,CAAoB,GAAG,CAAE7B,YAAzB,CAAuC,GAAG,CAAC,gBAA3C,EAAH,cAAoE,sCADhF,EADF,EAXF,GAFF,cAmBE,KAAC,OAAD,wBACE,YAAK,GAAG,CAAEa,IAAV,CAAgB,GAAG,CAAC,OAApB,EADF,EAnBF,cAsBE,KAAC,YAAD,EAAc,QAAQ,CAAEkB,QAAxB,CAAkC,QAAQ,CAAEY,QAA5C,CAAsD,WAAW,CAAEc,WAAnE,EAtBF,GADO,cAyBL,KAAC,OAAD,IA1BN,EADF,CA+BD,CA9HD,CAgIA,cAAepC,eAAf"},"metadata":{},"sourceType":"module"}